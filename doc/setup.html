<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<!--

  Copyright (c) 2007 Tridium, Inc
  Licensed under the Academic Free License version 3.0

  History:
    7 Mar 07  Brian Frank  Creation

-->

<!-- TOC-HEADER-START -->
<!-- Auto-generated by sedonac -->
<head>
  <title>Setup</title>
  <meta http-equiv='Content-type' content='text/html;charset=UTF-8' />
  <link rel='stylesheet' type='text/css' href='style.css'/>
</head>
<body>
<p>
  <a href='index.html'>
    <img src='logo.png' alt='Sedona'/>
  </a>
</p>
<div class='nav'>
  <a href='index.html'>Index</a>
 | <a href='intro.html'>Prev</a>
 | <a href='architecture.html'>Next</a>
</div>
<h1 class='title'>Setup</h1>
<div class='content'>
<!-- TOC-HEADER-END -->

<!-- /////////////////////////////////////////////////////// -->
<h1 id="overview">Overview</h1>
<!-- /////////////////////////////////////////////////////// -->

<p>
The root directory of your Sedona Framework installation is referred to
as <dfn>Sedona home</dfn>.  Relative directories specified by this
documentation are assumed relative to the Sedona home directory.
Sedona home is organized into the following sub directories:
</p>

<ul>
<li><b>adm</b>: administration scripts used to build and test</li>
<li><b>apps</b>: application files (.sab and .sax files)</li>
<li><b>bin</b>: win32 binaries and Unix shell scripts</li>
<li><b>doc</b>: documentation</li>
<li><b>kits</b>: standard directory used to store kit files</li>
<li><b>lib</b>: Java jar files and properties files</li>
<li><b>manifests</b>: directory for manifest database</li>
<li><b>platforms</b>: Contains source files used to stage Sedona Framework platforms, and
    also contains the platform database.</li>
<li><b>scode</b>: files related to linking scode images</li>
<li><b>src</b>: directory tree for Java, C, and Sedona source code</li>
</ul>

<!-- /////////////////////////////////////////////////////// -->
<h1 id="sedonac">Sedonac</h1>
<!-- /////////////////////////////////////////////////////// -->

<h2 id="windows">Windows</h2>

<p>
Sedona Framework development primarily centers around the "bin/sedonac.exe" executable.
If using the command line, you probably want to ensure that bin is in your path.
</p>

<p>
The compiler requires a Java Runtime of 1.4 or greater.  The
"sedonac.exe" launch executable will look in the registry to find
where your current VM is installed.  If you need to debug the launcher you
can run "sedonac --v" (that's two dashes before the 'v'), which
will trace the registry access and jvm.dll load.
</p>

<p>
To verify sedonac is correctly installed, run with the "-ver" option:
</p>

<pre>
D:\sedona\pub\src>sedonac -ver
Sedona Compiler 1.0.35
Copyright (c) 2007-2009 Tridium, Inc.
sedona.version = 1.0.35
sedona.home    = D:\sedona\pub
java.home      = C:\Program Files\Java\jre1.6.0_05
java.version   = 1.6.0_05
</pre>

<h2 id="unix">Unix</h2>

<p>
There is a bash shell script in "adm/unix" that you can use and modify to
initialize your Sedona Framework development environment. It is called <i>init.sh</i>.
In order to use this script, you must first
</p>
<ol>
<li>export JAVA_HOME in your login script.</li>
<li>create a symbolic link in your home directory called "sedonadev" that
points to your actual <dfn>Sedona home</dfn> directory. For example,
<pre>~/sedonadev -> ~/repos/sedona-1.0/pub</pre>
If you don't want to use this symbolic link, edit init.sh to explicitly set
the sedona_home environment variable.</li>
</ol>
<p>
After doing the above configuration, change your login script to run "init.sh".
This script will make sure some key programs are in your PATH, make
sure that all the python scripts have executable permissions, and create
some useful aliases.
</p>
<p>
There are two UNIX specific commands that you should use for building in a
UNIX environment
</p>

<ul>
<li><b>makeunixvm.py</b>:
  compile the unix svm using gcc. Run <i>makeunixvm -h</i> for more details</li>

<li><b>makeunixdev.py</b>:
  Builds sedona.jar, sedonac.jar, all opensource kits, and makes the unix svm.</li>
</ul>

<h2 id="java">Java Command Line</h2>

<p>
If you need to invoke Sedonac directly you can launch it directly
with Java:
</p>

<ul>
<li>Put lib/sedona.jar and lib/sedonac.jar in your classpath</li>
<li>Pass the installation directory to the "sedona.home" system property </li>
<li>Run the "sedonac.Main" class</li>
</ul>

<p>For example:</p>

<pre>
java -cp {lib}sedona.jar;{lib}sedonac.jar -Dsedona.home={home} sedonac.Main
</pre>

<!-- /////////////////////////////////////////////////////// -->
<h1 id="env">Environment</h1>
<!-- /////////////////////////////////////////////////////// -->

<p>
You can rebuild from source using the python scripts in the adm
directory.  These scripts are used to rebuild the compiler itself
and the SVM.  In order to use the python scripts, you will need
to install Python (version 2.7 or better).
Also the following environment variables must be defined:
</p>

<ul>
<li><b>sedona_home</b>: directory of your Sedona Framework installation (the
parent directory of adm, bin, lib, etc).</li>

<li><b>java_home</b>: directory of the Java JDK (1.4 or later).  Java
code is compiled with "adm/jikes.exe", but the JDK is used for "bin/jar.exe"
and "jre/lib/rt.jar".</li>

<li><b>win_sdk</b>: if you wish to compile the VM using the Visual
Studio C compiler then "win_sdk" should reference your Windows development
kit.  Also make sure you have run the "vcvars32.bat" script included in your
Visual Studio installation.  If you aren't going to recompile the SVM
for Win32, then this setup is unnecessary.</li>
</ul>

<p>
To verify your environment you can run the "adm/env.py" script, which
will print all the files and directories being used with your current
setup.
</p>

<!-- /////////////////////////////////////////////////////// -->
<h1 id="commands">Common Commands</h1>
<!-- /////////////////////////////////////////////////////// -->

<p>
The following commands are commonly used when building and running the Sedona Framework:
</p>

<ul>
<li><b>makesedona.py</b>:
  compile sedona runtime Java source into sedona.jar</li>

<li><b>makesedonac.py</b>:
  compile sedonac Java source into sedonac.jar (depends on sedona.jar)</li>

<li><b>makewinvm.py</b>:
  recompile svm.exe for Win32 using Visual Studio compiler</li>

<li><b>sedonac src\foo</b>:
  compile Sedona source for kit foo into foo.kit</li>

<li><b>sedonac scode\foo.xml</b>:
  link Sedona kits specified by foo.xml into foo.scode image file</li>

<li><b>sedonac apps\bar.sax</b>:
  compile a SAX file into a SAB file</li>

<li><b>svm scode\foo.scode apps\bar.sab</b>:
  run win32 SVM with the specified scode and app file</li>

<li><b>svm scode\foo.scode -test</b>:
  run test suite with the win32 SVM and the specified scode file</li>

<li><b>svm --plat</b>:<br/>
  For the open source win32 and unix svm implementations, this allows you
  to run the svm in "platform mode".  Running in platform mode allows the
  svm to handle restart commands, and it will handle loading staged scode
  and sab files.  The svm must be running in platform mode to pass the
  <a href="platCertified.html">certification test suite</a>.
  See the <b>svm</b> usage for more details.</li>

<li><b>makedev.py</b>:
  recompile all the commonly used targets and run tests with the win32 svm</li>
</ul>

<p>
Note that any command that builds the SVM will need to have the appropriate target
toolchain set up first.
</p>

<!-- TOC-FOOTER-START -->
<!-- Auto-generated by sedonac -->
</div>
<div class='nav'>
  <a href='index.html'>Index</a>
 | <a href='intro.html'>Prev</a>
 | <a href='architecture.html'>Next</a>
</div>
<div class='copyright'><script type='text/javascript'>document.write("Copyright &#169; " + new Date().getFullYear() + " Tridium, Inc.")</script></div>
</body>
<!-- TOC-FOOTER-END -->

</html>
